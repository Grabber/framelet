<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   
   <style type="text/css">
      .app {
         display: block;
         left: 0px;
         top: 0px;
      }

      .app-container {
         bottom: auto;
         display: block;
         height: 100%;
         left: 0px;
         position: absolute;
         right: auto;
         top: 0px;
      }

      .app-container-1 {
         border: none;
         height: 50%;
         left: auto;
         overflow: auto;
         position: fixed;
         right: auto;
         top: 50%;
         width: 100%;
      }
   </style>

   <title>framelet - parent</title>
</head>
<body>
   <div>
      <div>
         <input type="button" value="once" onclick="javascript:onceListener();"/>
         <input type="button" value="on" onclick="javascript:onListener();"/>
         <input type="button" value="off" onclick="javascript:offListener();"/>
         <input type="button" value="send" onclick="javascript:sendMessage();"/>
      </div>

      <pre id="list"></pre>
   </div>

   <div class="app" id="app">
      <div class="app-container" id="app-container">
         <iframe name="app" src="//127.0.0.1:8080/example/app.html" class="app-container-1" id="app-container-1"></iframe>
      </div>
   </div>

   <script src="//127.0.0.1:8080/dist/framelet.min.js"></script>

   <script type="application/javascript">
      var framelet = new Framelet('framelet', document.querySelector('#app-container-1').contentWindow);

      function listener(message) {
         const r = document.querySelector('#list');
         console.log(message);
         r.innerHTML = r.innerHTML + '\n' + message;
      }

      function onceListener() {
         framelet.once('app.*', listener);
      }

      function onListener() {
         framelet.on('app.*', listener);
      }

      function offListener() {
         framelet.off('app.*', listener);
      }

      function sendMessage() {
         framelet.send('app.data', new Date() + ' => ' + 'hello world!');
      }

      framelet.on('app.*', listener);
   </script>
</body>
</html>