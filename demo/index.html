<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <title>post-messenger - parent</title>
   <style>
      iframe, pre {
         width: 100%;
      }
   </style>
</head>
<body>
   <div id="root">
      <pre id="list"></pre>
      <iframe id="iframe" name="iframe_name" src="./iframe.html"></iframe>
      <div>
         <input type="button" value="Once" onclick="javascript: onceListener()" />
         <input type="button" value="On" onclick="javascript: onListener()" />
         <input type="button" value="Off" onclick="javascript: offListener()" />
         <input type="button" value="Send" onclick="javascript: sendMessage()" />
      </div>
   </div>
   <script src="../dist/post-messenger.min.js" type="application/javascript"></script>

   <script type="application/javascript">
      var framelet = new Framelet('medicaa', document.querySelector('#iframe').contentWindow);

      function listener(message) {
         const r = document.querySelector('#list');
         console.log(message);
         r.innerHTML = r.innerHTML + '\n' + message;
      }

      function onceListener() {
         framelet.once('iframe.*', listener);
      }

      function onListener() {
         framelet.on('iframe.*', listener);
      }

      function offListener() {
         framelet.off('iframe.*', listener);
      }

      function sendMessage() {
         framelet.send('iframe.data', new Date() + ', Hello world.');
      }
   </script>
</body>
</html>